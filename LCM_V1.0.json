{
  "openapi": "3.0.0",
  "info": {
    "title": "LCM Online Merchant API",
    "version": "1.0",
    "description": "LCM Online Merchant API's allows otp based loyalty points redemption from applications. Card Hodlers use their card at merchants using web applications for transactions amount equivalent to loyalty points. Customers receive OTP to registered mobile number using which web applications sends debit request towards LCM platform for completing transaction",
    "contact": {
      "name": "Tayana Software Solutions Pvt. Ltd.",
      "url": "www.tayanasoftware.com",
      "email": "supoprt@tayana.in"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000/lcm/v1"
    }
  ],
  "paths": {
    "/debit": {
      "parameters": [],
      "post": {
        "summary": "Debit",
        "operationId": "post-debit",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GenericResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GenericErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not Found"
          },
          "405": {
            "description": "Method Not Allowed"
          },
          "500": {
            "description": "Internal Server Error"
          }
        },
        "description": "Debit API allows web applications/merchants to debit amount for transactions initiated using Loyalty Card Number",
        "parameters": [
          {
            "$ref": "#/components/parameters/Authorization"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DebitRequest"
              }
            }
          },
          "description": "Debit Amount Request Schema"
        },
        "tags": [
          "Debit"
        ]
      }
    },
    "/{cardNumber}": {
      "parameters": [
        {
          "schema": {
            "type": "string"
          },
          "name": "cardNumber",
          "in": "path",
          "required": true,
          "description": "Card Number for which OTP transaction is initiated"
        }
      ],
      "get": {
        "summary": "GetOtp",
        "tags": [
          "GetOTP"
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GenericResponse"
                }
              }
            }
          }
        },
        "operationId": "get-merchant-loyaltyCardNumber",
        "description": "Api Used to sent OTP to Loyalty Card Holder for processing debit amount request ",
        "parameters": [
          {
            "$ref": "#/components/parameters/AppId"
          },
          {
            "$ref": "#/components/parameters/Authorization"
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "GenericResponse": {
        "description": "General API Response Schema",
        "type": "object",
        "x-examples": {
          "example-1": {
            "value": {
              "appTxnRefId": "string",
              "ocsTxnRefId": "string",
              "errorCode": 0,
              "status": 0,
              "description": "string"
            }
          }
        },
        "properties": {
          "appTxnRefId": {
            "type": "string",
            "minLength": 1,
            "description": "Application Transaction Reference Id received in request.",
            "maxLength": 50
          },
          "lcmTxnRefId": {
            "type": "string",
            "minLength": 1,
            "description": "Transaction Reference Id generated by LCM only for Debit Requests. Parameter exists in response if Error Code and Status for Debit is Success.",
            "maxLength": 50
          },
          "errorCode": {
            "type": "integer",
            "description": "Error Code",
            "format": "int32"
          },
          "status": {
            "description": "Response status \n0 : SUCCESS\n1 : FAILURE\n2 : PARTIAL SUCCESS\n3 : PENDING\n4 : TIMEOUT",
            "type": "integer"
          },
          "description": {
            "type": "string",
            "description": "Response Description, Usually describes the error code."
          }
        },
        "required": [
          "appTxnRefId",
          "errorCode",
          "status",
          "description"
        ],
        "title": "Generic Response"
      },
      "GenericErrorResponse": {
        "description": "General API Response Schema",
        "type": "object",
        "x-examples": {},
        "title": "GenericErrorResponse",
        "properties": {
          "appTxnRefId": {
            "type": "string",
            "minLength": 1,
            "description": "Application Transaction Reference Id received in request.",
            "maxLength": 50
          },
          "lcmTxnRefId": {
            "type": "string",
            "minLength": 1,
            "description": "Optional Parameter. Does not exist for Error Response",
            "maxLength": 50
          },
          "status": {
            "description": "Response status \n0 : SUCCESS\n1 : FAILURE\n2 : PARTIAL SUCCESS\n3 : PENDING\n4 : TIMEOUT",
            "type": "integer"
          },
          "errorCode": {
            "type": "integer",
            "format": "int32"
          },
          "error": {
            "type": "array",
            "description": "Response Description, Usually describes the error code.",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "appTxnRefId",
          "status"
        ]
      },
      "DebitRequest": {
        "title": "DebitRequest",
        "type": "object",
        "description": "Model used to form Debit Request",
        "x-tags": [
          "CreateBR"
        ],
        "properties": {
          "appTxnRefId": {
            "type": "string",
            "minLength": 1,
            "maxLength": 50,
            "description": "Application Transaction Ref Id"
          },
          "cardNumber": {
            "type": "string",
            "description": "Loyalty Card Number of Subscriber",
            "format": "int64"
          },
          "amount": {
            "type": "number",
            "format": "float",
            "description": "Amount to be Debited"
          },
          "otp": {
            "type": "string",
            "description": "One time transaction password"
          }
        },
        "required": [
          "appTxnRefId",
          "cardNumber",
          "amount",
          "otp"
        ]
      }
    },
    "securitySchemes": {},
    "parameters": {
      "AppId": {
        "name": "AppId",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50
        },
        "description": "Application Transaction Reference Id"
      },
      "Authorization": {
        "name": "Authorization",
        "in": "header",
        "schema": {
          "type": "string",
          "example": "Basic dXNlcm5hbWU6cGFzc3dvcmQ="
        },
        "description": "API authentication  for external systems is done by HTTP basic authentication 'username: password' and is encoded in base64 and sent under the Authorization header",
        "required": true
      }
    }
  },
  "tags": [
    {
      "name": "Debit"
    },
    {
      "name": "GetOTP"
    }
  ]
}
